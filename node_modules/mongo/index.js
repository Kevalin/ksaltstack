var mongoose = require('mongoose');

/*var action = function(options) {
    var host = options.host || '127.0.0.1';
    var port = options.port || 27017;
    var dbname = options.dbname;
    var uri = 'mongodb://' + host + ':' + port + '/' + dbname;
    mongoose.connect(uri);
    var db = mongoose.connection;
    //var db = mongoose.createConnection(uri);
    db.on('error', function(err) {
        console.log('connect mongo error: ', err)
    });
    db.once('open', function() {
        console.log('db connection open')
    });
    var schema = new mongoose.Schema({any: {}});
    return db.model(dbname, schema, dbname);
};*/

var action = function() {
    return function(options) {
        var host = options.host || '127.0.0.1';
        var port = options.port || 27017;
        var dbname = options.dbname;
        var uri = 'mongodb://' + host + ':' + port + '/' + dbname;
        mongoose.connect(uri);
        var db = mongoose.connection;
        //var db = mongoose.createConnection(uri);
        db.on('error', function(err) {
            console.log('connect mongo error: ', err)
        });
        db.once('open', function() {
            console.log('db connection open')
        });
    }
};

module.exports = action;